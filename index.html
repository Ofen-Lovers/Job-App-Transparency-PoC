<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Application Transparency PoC</title>
    <!-- TODO: [JHON] CSS time nimo idol -->
</head>
<body>

    <h1>Job Application Portal</h1>
    
    <!-- Mode Selection -->
    <fieldset id="mode-selection">
        <legend>Select System Mode:</legend>
        <div>
            <input type="radio" id="mode-blackbox" name="mode" value="blackbox" checked>
            <label for="mode-blackbox">Black Box Mode (Fast, Opaque)</label>
        </div>
        <div>
            <input type="radio" id="mode-transparent" name="mode" value="transparent">
            <label for="mode-transparent">Transparent Mode (Slower, Explains Decisions)</label>
        </div>
    </fieldset>

    <hr>

    <!-- Application Form -->
    <form id="application-form">
        <div>
            <label for="gpa">GPA (0.0 - 4.0):</label>
            <input type="number" id="gpa" name="gpa" step="0.1" min="0" max="4" required>
        </div>
        <br>
        <div>
            <label for="experience">Years of Experience:</label>
            <input type="number" id="experience" name="experience" min="0" required>
        </div>
        <br>
        <button type="submit" id="submit-btn">Apply Now</button>
    </form>

    <hr>

    <!-- Result Display -->
    <div id="result-area" style="display:none;">
        <h3 id="result-title"></h3>
        <p id="result-message"></p>
        <ul id="explanation-list"></ul>
    </div>

    <script>
        // Configuration
        const CONFIG = {
            thresholds: {
                gpa: 3.0,
                experience: 3
            },
            delays: {
                transparent: 1000 // 1 second delay to simulate processing
            }
        };

        // DOM Elements
        const form = document.getElementById('application-form');
        const resultArea = document.getElementById('result-area');
        const resultTitle = document.getElementById('result-title');
        const resultMessage = document.getElementById('result-message');
        const explanationList = document.getElementById('explanation-list');

        function init() {
            form.addEventListener('submit', handleSubmission);
        }

        function handleSubmission(event) {
            event.preventDefault();
            
            // Get selected mode
            const mode = document.querySelector('input[name="mode"]:checked').value;
            const submitBtn = document.getElementById('submit-btn');
            
            // TODO: [JOSEPH] Add input validation here (ensure GPA is 0-4, etc.)
            const gpa = parseFloat(document.getElementById('gpa').value);
            const experience = parseInt(document.getElementById('experience').value);
            
            if (isNaN(gpa) || isNaN(experience)) {
                alert("Please enter valid numbers for GPA and Experience.");
                return;
            }

            // Disable button during processing
            submitBtn.disabled = true;
            submitBtn.textContent = "Processing...";
            
            // Reset Display
            resultArea.style.display = 'none';
            explanationList.innerHTML = '';

            if (mode === 'transparent') {
                // transparent mode delay
                setTimeout(() => {
                    processApplication(gpa, experience, mode);
                    submitBtn.disabled = false;
                    submitBtn.textContent = "Apply Now";
                }, CONFIG.delays.transparent);
            } else {
                // Black Box Mode: Immediate
                processApplication(gpa, experience, mode);
                submitBtn.disabled = false;
                submitBtn.textContent = "Apply Now";
            }
        }

        function processApplication(gpa, experience, mode) {
            const result = evaluateCandidate(gpa, experience);
            displayResult(result, mode, gpa, experience);
        }

        function evaluateCandidate(gpa, experience) {
            // Basic Scoring Logic
            const passedGpa = gpa >= CONFIG.thresholds.gpa;
            const passedExp = experience >= CONFIG.thresholds.experience;
            const accepted = passedGpa && passedExp;
            
            // Dummy score calculation
            const score = (gpa / 4.0 * 0.5) + (Math.min(experience, 10) / 10 * 0.5);

            return { accepted, score: score.toFixed(2), passedGpa, passedExp };
        }

        function displayResult(result, mode, gpa, experience) {
            resultArea.style.display = 'block';
            
            if (result.accepted) {
                resultTitle.textContent = "ACCEPTED";
                resultMessage.textContent = "Congratulations! You meet all our criteria.";
            } else {
                resultTitle.textContent = "REJECTED";
                
                if (mode === 'transparent') {
                    resultMessage.textContent = `Application rejected. Score: ${result.score}.`;
                    
                    // Transparent Mode: Show specific reasons
                    // TODO: [JOSEPH] This should eventually be replaced by the helper function
                    const reasons = [];
                    if (!result.passedGpa) {
                        reasons.push(`GPA ${gpa} is below the required ${CONFIG.thresholds.gpa}.`);
                    }
                    if (!result.passedExp) {
                        reasons.push(`Experience ${experience} years is below the required ${CONFIG.thresholds.experience} years.`);
                    }

                    reasons.forEach(reason => {
                        const li = document.createElement('li');
                        li.textContent = reason;
                        explanationList.appendChild(li);
                    });
                } else {
                    // Black Box Mode: Show generic message
                    resultMessage.textContent = `Score: ${result.score}. We have decided not to proceed with your application.`;
                }
            }
        }

        init();
    </script>
</body>
</html>
